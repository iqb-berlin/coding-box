<h2 mat-dialog-title>
  Upload Optionen ({{ data.resultType === 'logs' ? 'Logs' : 'Responses' }})
</h2>

<div mat-dialog-content>
  <mat-form-field appearance="outline" style="width: 100%;">
    <mat-label>Geltungsbereich (Scope)</mat-label>
    <mat-select [(ngModel)]="scope">
      <mat-option value="person">person (Standard, sicher)</mat-option>
      <mat-option value="workspace">workspace</mat-option>
      <mat-option value="group">group</mat-option>
      <mat-option value="booklet">booklet</mat-option>
      <mat-option value="unit">unit</mat-option>
      <mat-option value="response">response (variableId + subform)</mat-option>
    </mat-select>
  </mat-form-field>

  <div class="help">
    <div class="help-row">
      <div class="mode">person</div>
      <div class="desc">Es werden nur die Testpersonen verarbeitet, die in der Upload-Datei vorkommen. Andere Personen im Workspace bleiben unberührt.</div>
    </div>
    <div class="help-row">
      <div class="mode">workspace</div>
      <div class="desc">Der Import kann sich auf den gesamten Workspace auswirken (potenziell riskanter).</div>
    </div>
    <div class="help-row">
      <div class="mode">group</div>
      <div class="desc">Nur Testpersonen in der angegebenen Gruppe werden verarbeitet.</div>
    </div>
    <div class="help-row">
      <div class="mode">booklet</div>
      <div class="desc">Nur das angegebene Booklet wird verarbeitet (innerhalb der betroffenen Personen).</div>
    </div>
    <div class="help-row">
      <div class="mode">unit</div>
      <div class="desc">Nur die angegebene Unit (Name oder Alias) wird verarbeitet.</div>
    </div>
    <div class="help-row">
      <div class="mode">response</div>
      <div class="desc">Nur Antworten für variableId + subform werden verarbeitet (maximal spezifisch).</div>
    </div>
  </div>

  @if (scope === 'group') {
    <mat-form-field appearance="outline" style="width: 100%;">
      <mat-label>Gruppenname</mat-label>
      <input matInput [(ngModel)]="groupName" placeholder="z.B. GruppeA" />
    </mat-form-field>
  }

  @if (scope === 'booklet') {
    <mat-form-field appearance="outline" style="width: 100%;">
      <mat-label>Booklet</mat-label>
      <input matInput [(ngModel)]="bookletName" placeholder="z.B. BOOKLET_01" />
    </mat-form-field>
  }

  @if (scope === 'unit') {
    <mat-form-field appearance="outline" style="width: 100%;">
      <mat-label>Unit (Name oder Alias)</mat-label>
      <input matInput [(ngModel)]="unitNameOrAlias" placeholder="z.B. UNIT_01" />
    </mat-form-field>
  }

  @if (scope === 'response') {
    <mat-form-field appearance="outline" style="width: 100%;">
      <mat-label>variableId</mat-label>
      <input matInput [(ngModel)]="variableId" placeholder="z.B. A1" />
    </mat-form-field>
    <mat-form-field appearance="outline" style="width: 100%;">
      <mat-label>subform</mat-label>
      <input matInput [(ngModel)]="subform" placeholder="z.B. 0" />
    </mat-form-field>
  }

  <mat-form-field appearance="outline" style="width: 100%;">
    <mat-label>Umgang mit bestehenden Daten</mat-label>
    <mat-select [(ngModel)]="overwriteMode">
      <mat-option value="skip">skip (Standard)</mat-option>
      <mat-option value="merge">merge</mat-option>
      <mat-option value="replace">replace</mat-option>
    </mat-select>
  </mat-form-field>

  <div class="help">
    <div class="help-row">
      <div class="mode">skip</div>
      <div class="desc">Wenn ein Eintrag bereits existiert, wird er nicht verändert und der Upload-Teil wird übersprungen.</div>
    </div>
    <div class="help-row">
      <div class="mode">merge</div>
      <div class="desc">Nur fehlende Einträge werden ergänzt (keine Überschreibung).</div>
    </div>
    <div class="help-row">
      <div class="mode">replace</div>
      <div class="desc">Bestehende Einträge werden im betroffenen Bereich gelöscht und durch den Upload ersetzt.</div>
    </div>
  </div>
</div>

<div mat-dialog-actions align="end">
  <button mat-button type="button" (click)="close()">Abbrechen</button>
  <button mat-raised-button color="primary" type="button" (click)="confirm()">Upload starten</button>
</div>
