<div class="replay-container" [class.print-mode]="isPrintMode" [class.booklet-mode]="isBookletMode">
  <cb-spinner [isLoaded]="isLoaded"></cb-spinner>

  @if (isBookletMode && !!player && unitDef) {
    <coding-box-booklet-replay
      [bookletData]="bookletData"
      (unitChanged)="handleUnitChanged($event)">
    </coding-box-booklet-replay>
  }

  @if (!!player && unitDef) {
    @for (key of [reloadKey]; track key) {
      <coding-box-unit-player
        [unitDef]="unitDef"
        [unitPlayer]="player"
        [unitResponses]="responses"
        [pageId]="page"
        [printMode]="isPrintMode"
        (invalidPage)="checkPageError($event)">
      </coding-box-unit-player>
    }
  }

  @if (testPerson && unitId) {
    <div class="watermark">{{ testPerson }} - {{ unitId }}</div>
  }
</div>
